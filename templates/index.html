<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paillier Cryptosystem Interface</title>
    <script>
        async function generateKeys() {
            const response = await fetch('/generate_keys', { method: 'POST' });
            const data = await response.json();
            document.getElementById('pub_key').value = JSON.stringify(data.pub_key);
            document.getElementById('priv_key').value = JSON.stringify(data.priv_key);
        }

        async function encryptScores() {
            const scores = document.getElementById('scores').value.split(',').map(Number);
            const pub_key = JSON.parse(document.getElementById('pub_key').value);
            const response = await fetch('/encrypt', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ scores, pub_key })
            });
            const data = await response.json();
            document.getElementById('encrypted_scores').value = JSON.stringify(data.encrypted_scores);
        }

        async function computeResult() {
            const encrypted_scores = JSON.parse(document.getElementById('encrypted_scores').value);
            const pub_key = JSON.parse(document.getElementById('pub_key').value);
            const response = await fetch('/compute', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ encrypted_scores, pub_key })
            });
            const data = await response.json();
            document.getElementById('encrypted_result').value = data.encrypted_result;
        }

        async function decryptResult() {
            const encrypted_result = parseInt(document.getElementById('encrypted_result').value, 10);
            const priv_key = JSON.parse(document.getElementById('priv_key').value);
            const response = await fetch('/decrypt', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ encrypted_result, priv_key })
            });
            const data = await response.json();
            document.getElementById('decrypted_result').textContent = data.decrypted_result;
        }
    </script>
</head>
<body>
    <h1>Paillier Cryptosystem Interface</h1>
    <button onclick="generateKeys()">Generate Keys</button>
    <br><br>
    <label>Public Key:</label>
    <input id="pub_key" type="text" readonly><br>
    <label>Private Key:</label>
    <input id="priv_key" type="text" readonly><br><br>

    <label>Scores (comma-separated):</label>
    <input id="scores" type="text"><br>
    <button onclick="encryptScores()">Encrypt Scores</button><br>
    <label>Encrypted Scores:</label>
    <input id="encrypted_scores" type="text" readonly><br><br>

    <button onclick="computeResult()">Compute Result</button><br>
    <label>Encrypted Result:</label>
    <input id="encrypted_result" type="text" readonly><br><br>

    <button onclick="decryptResult()">Decrypt Result</button><br>
    <label>Decrypted Result:</label>
    <span id="decrypted_result"></span>
</body>
</html>
